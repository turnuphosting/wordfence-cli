# Malware Scan Configuration

Configuration can be set through command line arguments, or configured globally through the wordfence-cli.ini file. Once Wordfence CLI is installed, we recommend running `./wordfence configure` to interactively setup Wordfence CLI's global configuration.

## wordfence-cli.ini

By default, `wordfence-cli.ini` will reside in `~/.config/wordfence/wordfence-cli.ini`. The INI file is best suited for global configuration options for Wordfence CLI. The license is typically all that's needed to be stored in the INI. You can optionally store the arguments that appear below in the INI if you choose. Keep in mind, that the examples in the documentation here may not work as expected when using scan options stored in the INI.

In order to store malware scan specific configuration in the INI file, you should use `[MALWARE_SCAN]` as the INI section. Here's basic example of an INI file that uses default configuration options along with malware scan options:

	[DEFAULT]
	license = xxx
	cache-directory = /usr/local/wordfence-cli

	[MALWARE_SCAN]
	workers = 16
	exclude-signatures = 99999

## Malware Scan Command Line Arguments

- `--read-stdin`: Read paths from stdin. If not specified, paths will automatically be read from stdin when input is not from a TTY.
- `-s`, `--file-list-separator`: Separator used when listing files via stdin. Defaults to the null byte.
- `--output`: Write results to stdout. This is the default behavior when --output-path is not specified.
- `--output-path`: Path to which to write results.
- `--output-columns`: An ordered, comma-delimited list of columns to include in the output. Available columns: `filename`, `signature_id`, `signature_name`, `signature_description`, `matched_text`. Compatible formats: csv, tsv, null-delimited, line-delimited, human.
- `-m`, `--output-format`: Output format used for result data.
- `--output-headers`: Include column headers in output. Compatible formats: csv, tsv, null-delimited, line-delimited.
- `-e`, `--exclude-signatures`: Specify rule IDs to exclude from the scan. Can be comma-delimited and/or specified multiple times.
- `-i`, `--include-signatures`: Specify rule IDs to include in the scan. Can be comma-delimited and/or specified multiple times.
- `--images`: Include image files in the scan.
- `-a`, `--include-all-files`: Scan all files. By default, only files matching certain extensions are scanned
- `-n`, `--include-files`: Only scan filenames that are exact matches. Can be used multiple times.
- `-x`, `--exclude-files`: Do not scan filenames that are exact matches. Can be used multiple times. Denials take precedence over allows.
- `-N`, `--include-files-pattern`: Python regex allow pattern. Only matching filenames will be scanned.
- `-X`, `--exclude-files-pattern`: Python regex deny pattern. Matching filenames will not be scanned.
- `--allow-io-errors`: Allow scanning to continue if IO errors are encountered. Files that cannot be read will be skipped and a warning will be logged.
- `-z`, `--chunk-size`: Size of file chunks that will be scanned. Use a whole number followed by one of the following suffixes: b (byte), k (kibibyte), m (mebibyte). Defaults to 3m.
- `-M`, `--scanned-content-limit`: The maximum amount of data to scan in each file. Content beyond this limit will not be scanned. Defaults to 50 mebibytes. Use a whole number followed by one of the following suffixes: b (byte), k (kibibyte), m (mebibyte).
- `--match-engine`: The regex engine to use for malware scanning. Options: `pcre`, `vectorscan` (default: `pcre`)
- `--match-all`: If set, all possible signatures will be checked against each scanned file. Otherwise, only the first matching signature will be reported
- `--pcre-backtrack-limit`: The regex backtracking limit for signature evaluation
- `--pcre-recursion-limit`: The regex recursion limit for signature evaluation
- `-w`, `--workers`: Number of worker processes used to perform scanning. Defaults to 1 worker process.
- `--progress`: Display scan progress in the terminal with a curses interface
